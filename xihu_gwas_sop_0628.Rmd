---
title: "xihu gwas 0628"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# a1 data import

## raw data overview

Ë°®Âûã:Êó©‰∫ß„ÄÅË∂ÖÂ§ßË∂ÖÂ∞èÂ©¥ÂÑø(lowbirthwt„ÄÅmacrosomia)„ÄÇlogistic„ÄÇ

durationÔºàÂ≠ïÊúüÔºâ linear„ÄÇ

+----+------------+----------+-----------+---------+----------------+----------------------------------------------+
| id | Ë°®Âûã       | ÊñπÊ≥ï     | ÂçèÂèòÈáè    | Ê†∑Êú¨ÈáèN | Job id         | gwas name                                    |
+====+============+==========+===========+=========+================+==============================================+
| 1  | perterm    | logistic | pca10+age | 4342    | FUMA_job186763 | res_pca10_age_4000.assoc_pvalue2.logistic.gz |
+----+------------+----------+-----------+---------+----------------+----------------------------------------------+
| 1  | lowbirthwt | logistic | pca10+age | 4342    | xxx            | xxx                                          |
+----+------------+----------+-----------+---------+----------------+----------------------------------------------+
| 1  | macrosomia | logistic | pca10+age | 4342    | xxx            | xxx                                          |
+----+------------+----------+-----------+---------+----------------+----------------------------------------------+

## cov(xxbmld) = pca + Âπ¥ÈæÑ

Ê†∑Êú¨Êï∞‰∏ÄËá¥„ÄÇ

# a2 plink command

## ÈòàÂÄºÊÄßÁä∂Ôºà1,2Ôºâ-\> logisticÈÄªËæëÂõûÂΩí

ÁóÖ‰æãÂØπÁÖßÁ†îÁ©∂ ÔºàCase-control studyÔºâ: ÊòØÊåá‰ª•Áé∞Âú®ÊÇ£ÊúâÊüêÁóÖÁöÑÁóÖ‰∫∫‰∏∫ÊÇ£ÁóÖÁªÑÔºàÁß∞‰∏∫ CaseÔºâÔºå‰ª•Êú™ÊÇ£ËØ•ÁóÖ‰ΩÜÂÖ∂ÂÆÉÊù°‰ª∂‰∏éÁóÖ‰æãÁªÑÁõ∏‰ººÁöÑ‰∫∫‰∏∫Âè¶ÂØπÁÖßÁªÑÔºàÁß∞‰∏∫ ControlÔºâ„ÄÇ\
plink ÁöÑËØ≠Â¢ÉÂè´"case and control"ÔºåÂç≥Ë°®ÂûãÂÄºÊï∞ÊçÆÊòØ‰∏§Á±ªÊï∞ÊçÆÔºö1,2ÔºàÊòØÔºåÂê¶Ôºü„ÄêÊó©‰∫ß Â∑®Â§ßÂÑøÔºü„ÄëÔºâÔºåÂÖ∂‰∏≠ 0 Âíå-9 ÈÉΩË°®Á§∫Áº∫Â§±„ÄÇ

| data                           | Êù•Ê∫ê              | ÊòØÂê¶gwas |
|--------------------------------|-------------------|----------|
| raw¬†data¬†fam¬†file              | [***4945***]{.ul} |          |
| excel¬†Phenotype¬†table          | 4946              |          |
| excel¬†Phenotype¬†table¬†È™åËØÅÂ≠êÈõÜ | 1063              | 1?       |
| gwasË°®Âûãraw¬†dataÊï∞¬†            | [*4342*]{.ul}     | 1        |
| È™åËØÅÂ≠êÈõÜ¬†raw¬†data¬†Êï∞           | 527               |          |
| Â∑®Â§ßÔºàÂ∞èÔºâÂÑøÈõÜ¬†excel¬†Phenotype¬†table           | 4898               |    0      |
| Â∑®Â§ßÔºàÂ∞èÔºâÂÑøÈõÜ¬†raw¬†data¬†Êï∞(Ë°®Âûã‰ø°ÊÅØold&huge‰∫§ÈõÜ)           | 1513               |     0     |
| Â∑®Â§ßÔºàÂ∞èÔºâÂÑøÈõÜ¬†raw¬†data¬†Êï∞ÔºàË°®Âûã‰ø°ÊÅØold&huge&fam‰∫§ÈõÜÔºâ           | 4342               |    1      |




```{bash}
#eg 4760 = 4946 -> drop_na(preterm)
/home/wangzhe/projects/gwas/SNP_data/selected_two_cohorts -> raw data
wc -l /home/wangzhe/projects/xihu2gwas_github/phe2plus00.txt -> bcx; üÜö Ôºàrow 4760Ôºâ
wc -l /home/wangzhe/projects/gwas/SNP_data/gcta_pca/pca10_age_4000.txt -> cov üÜö Ôºàrow 4342Ôºâ
wc -l /home/wangzhe/projects/xihu2gwas_github/phe2plus00.txt (4760)

[/home/wangzhe/projects/gwas/SNP_data/gcta_pca]wc -l pca10.eigenvec
4945 pca10.eigenvec

Âà∂‰Ωúlowbirthwt„ÄÅmacrosomiaÔºåÁúãÁúãÊòØÂê¶‰øÆÊîπcov
Ëøô‰∏™ÊòØÂê¶Áî®1Ôºå0Ë°®Á§∫Ôºü
ID	lowbirthwt	macrosomia
V1_0010202	0	0
V1_0010204	0	0
V1_0010205	0	0

Ê≠§Â§ÑÊòØÂê¶Áî®1Ôºå2Ë°®Á§∫Ôºü
0010202 0010202 2
0010204 0010204 2
0010205 0010205 2

Êï∞ÊçÆÂ§ÑÁêÜÔºåmerge than Êää0 -> 2

1513 phe
1513 cov
# hi.R


```

```{bash}
#eg
#plink --bfile /home/wangzhe/projects/gwas/SNP_data/selected_two_cohorts --pheno /home/wangzhe/projects/github_star/GWA_tutorial/phe2.txt --logistic --covar /home/wangzhe/projects/gwas/SNP_data/gcta_pca/pca10_age_4000.txt --out res_pca10_age_4000xxx --allow-no-sex

plink --bfile /home/wangzhe/projects/gwas/SNP_data/selected_two_cohorts --pheno /home/wangzhe/projects/xihu2gwas_github/phe2plus00.txt --logistic --covar /home/wangzhe/projects/gwas/SNP_data/gcta_pca/pca10_age_4000.txt --out re_logistic --allow-no-sex

# togo
## lowbirthwt
plink --bfile /home/wangzhe/projects/gwas/SNP_data/selected_two_cohorts --pheno /home/wangzhe/projects/xihu2_0628/data/phe_sma.txt --logistic --covar /home/wangzhe/projects/xihu2_0628/data/pca10_age_4342.txt --out re_logistic_pca10_age_4342_low --allow-no-sex
## macrosomia
plink --bfile /home/wangzhe/projects/gwas/SNP_data/selected_two_cohorts --pheno /home/wangzhe/projects/xihu2_0628/data/phe_huge.txt --logistic --covar /home/wangzhe/projects/xihu2_0628/data/pca10_age_4342.txt --out re_logistic_pca10_age_4342_huge --allow-no-sex

```

## ËøûÁª≠ÊÄßÁä∂ÔºàÂÆöÈáèÊÄßÁä∂Ôºâlinear

# a3 output data

# plot

# with python
